# PollingService
<p><b>PolingService</b> API для системы опросов пользователей.<p/>
<p>Создано с использованием: Java 11, Spring-Boot, Spring Security, Spring Data JPA.<p/>
<p><b>Для работы потребуется:</b></p>

<ul>
<li><b>Java 11 версии</b></li>
<li><b>TomCat (версия не ниже 8.5)</b></li>
<li><b>БД PostgreSQL (тестировалось на 13 вер.)</b></li>
<li><b>Postman или другой клиент для работы с API, можно использовать Swagger
 (после запуска сервиса перейдите /swagger-ui/)</b></li>
</ul>

<p>Подготовка к работе сервиса (на localhost):</p>
<ul>
<li>Запустить сервер БД (если не запущен) и создать структуру таблиц в БД:
 выполнить в консоли код из файла db/migration/V1_0__PollingService_DDL.sql</li>
<li>Запустить TomCat (например, перейти \apache-tomcat-8.5.66\bin в консоли, выполнить catalina start)
 и скопировать архив с приложением(PollingService.war) в \apache-tomcat-8.5.66\webapps. 
 War-архив автоматически распакуется и приложение будет доступно на localhost.</li>
<li>Для работы с API можно использовать Postman или другой клиент,
 также можно использовать Swagger (после запуска сервиса перейдите /swagger-ui/)</li>
</ul>

<p>Описание структуры ru.goryachev.pollingservice:</p>
<ul>
<li>api - классы контроллеров или routes</li>
<li>app - классы инициализации/запуска</li>
<li>model - классы сущностей Entity (по таблицам из БД), DTO (сформированные для пользователя сущности), проекции DTO, классы композитных ключей</li>
<li>repository - расширение интерфейсов JPA</li>
<li>service - классы для логики, логика разделёна по сущностям</li>
<li>exception - классы Advice контроллеров (отлавливают все исключения в api контроллерах) и описания исключений</li>
</ul>

<p>Модель данных</p>

![PollingService_DB_diagram_v1_0](https://user-images.githubusercontent.com/61917893/159596559-0a2987a4-ff10-4024-8543-611ca55aa86f.jpg)

<p>Общее описание:</p>
<p>В таблицу poll вносятся Опросы. Таблица Вопросы questions имеет внешний ключ на Опросы,
 аналогично Ответы answers на Вопросы.</p>
 <p>Запись в таблице answers может иметь пустой внешний ключ в том случае, если ответ вносит пользователь.
 Запись в таблице answers имеет внешний ключ только в том случае, если Ответ является стандартным для определённого Вопроса,
 и, соответственно, внешний ключ ссылается на этот Вопрос 
 (пользователь должен выбрать один из ответов).</p>
 <p>Имеется связующая таблица Результаты spresult, можно сделать выборку результатов.</p>

<p>Lev Goryachev 2022</p>
